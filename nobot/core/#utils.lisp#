(uiop:define-package :nobot/core/utils
    (:use :cl)
  (:export :with-gensyms
           :is-eq-val-?))

(defmacro with-gensyms (args &body body)
  `(let ,(mapcar (lambda (arg)
                   `(,arg (gensym)))
                 args)
     ,@body))

(defmacro is-test-var-? (var args &key (test #'eq))
  (with-gensyms (test-var)
    `(let ((,test-var ,var))
       (or
        ,@ (mapcar (lambda (arg)
                     `(funcall ,test
                               ,test-var
                               ,(if (or (symbolp arg)
                                        (listp arg))
                                    `,arg
                                    arg)))
                   args)))))
